document.addEventListener("DOMContentLoaded",(function(){var t;(t=window).parseParams=function(t,e){let n=[];return 0===Object.keys(e).length||(Object.keys(e).forEach((t=>e[t]&&n.push(`${t}=${e[t]}`))),-1===t.search(/\?/)?t+=`?${n.join("&")}`:t+=`&${n.join("&")}`),t},t.request=function(e){e=Object.assign({url:"",method:"GET",header:{},data:{},callback:null,error_callback:null,timeout:3e4},e);let n=new XMLHttpRequest;"GET"===e.method&&(e.url=t.parseParams(e.url,e.data)),n.open(e.method,e.url,!0),n.timeout=e.timeout;let r="";if(document.querySelector('meta[name="csrf-token"]')&&(r=document.querySelector('meta[name="csrf-token"]').getAttribute("content")),n.setRequestHeader("X-CSRF-TOKEN",r),e.header)for(let t in e.header)e.header.hasOwnProperty(t)&&n.setRequestHeader(t,e.header[t]);"GET"===e.method?(n.setRequestHeader("Content-type","application/text;charset=UTF-8"),n.responseType="text",n.send(null)):(e.data instanceof FormData?n.setRequestHeader("X-Requested-With","XMLHttpRequest"):(n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),e.data=JSON.stringify(e.data)),n.responseType="json",n.send(e.data)),n.onload=function(){this.status>=200&&this.status<300||"function"==typeof e.error_callback&&e.error_callback()},n.onreadystatechange=function(){if(n.readyState===n.DONE&&200===n.status){let t=n.response;"function"==typeof e.callback&&e.callback(t)}},n.onerror=function(t){console.error(t),"function"==typeof e.error_callback&&e.error_callback(t)}},t.Pagination=class{constructor(t,e,n){t instanceof HTMLElement?this.DOM=t:this.DOM=document.querySelector(t),this.totalPages=e,this.currentPage=n}visiblePageCount(t){return this.visiblePagesCount=t-2,this}bindEvent(t){return"function"!=typeof t||(this.callback=t),this}format(t){return this.url=t,this}make(){if(this.totalPages<=1)return;(this.currentPage>this.totalPages||this.currentPage<1)&&(this.currentPage=1);let t=document.createElement("ul");if(t.className="dlp-pagination",this.DOM.append(t),this.renderButton(t,"‹",this.currentPage>1?this.currentPage-1:1),this.renderButton(t,"1",1),this.currentPage>4){let e=this.url;this.url=void 0,this.renderButton(t,"...",-1),this.url=e}let e=7;this.visiblePagesCount&&(e=this.visiblePagesCount);let n=Math.max(2,this.currentPage-Math.floor(e/2)),r=Math.min(this.totalPages-1,n+e-1);for(let e=n;e<=r;e++)this.renderButton(t,e.toString(),e);if(this.currentPage<this.totalPages-3&&r<this.totalPages-1){let e=this.url;this.url=void 0,this.renderButton(t,"...",-1),this.url=e}this.renderButton(t,this.totalPages.toString(),this.totalPages),this.renderButton(t,"›",this.currentPage<this.totalPages?this.currentPage+1:this.totalPages)}renderButton(t,e,n){const r=document.createElement("li");-1===n?r.className="dlp-pagination-page skip":this.currentPage===n&&"‹"!==e&&"›"!==e?r.className="dlp-pagination-page current":r.className="dlp-pagination-page";const a=document.createElement("a");this.url&&-1!==n?a.setAttribute("href",this.url.replace(":page",n)):a.setAttribute("href","javascript:void(0);"),a.innerText=e,"function"==typeof this.callback&&a.addEventListener("click",(()=>this.callback(n))),r.append(a),t.appendChild(r)}},t.search=class{constructor(){this.input_dom=document.querySelector("#search>input"),this.button_dom=document.querySelector("#search>.search-button"),this.button_dom.addEventListener("click",(()=>{this.input_dom.value&&(this.input_dom.value=this.input_dom.value.replace(/[!@#$%^&*()_+\{\}:“<>?,.\/;'\[\]\\|`~"\'【】！，。、]+/g,""),this.input_dom.value=this.input_dom.value.substring(0,64),window.location.href=new URL(window.location.href).origin+"/search?keywords="+this.input_dom.value)}))}},new t.search,t.logger=class{constructor(){document.querySelector('meta[name="token"]')instanceof HTMLElement&&this.push().then((t=>{const e=videojs("video",{autoplay:!1},(function(){e.src({src:t,type:"application/x-mpegURL"})}));document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState?player.pause():player.play()}))}))}push(){const t=crypto.subtle.importKey("raw",(new TextEncoder).encode(document.querySelector(".video-box").getAttribute("id")),{name:"AES-CBC",length:256},!1,["decrypt"]),e=new Uint8Array(16),n=new Uint8Array(Array.from(atob(document.querySelector('meta[name="token"]').getAttribute("content")),(t=>t.charCodeAt(0))));e.set(n);const r=new Uint8Array(Array.from(atob(document.querySelector('meta[name="key"]').getAttribute("content")),(t=>t.charCodeAt(0))));return t.then((t=>crypto.subtle.decrypt({name:"AES-CBC",iv:e},t,r))).then((t=>(new TextDecoder).decode(t.slice(16)))).catch((t=>console.error(t)))}},new t.logger}));